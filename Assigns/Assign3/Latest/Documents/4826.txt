Enigma machine
The Enigma machine is any of a family of related electro-mechanical rotor machines that have been used to generate ciphers for the encryption and decryption of secret messages. The Enigma was invented by German engineer Arthur Scherbius at the end of World War I.[1] It was used commercially from the early 1920s and was adopted by military and governmental services of a number of countries — most notably by Nazi Germany before and during World War II.[2] A variety of Enigma models were produced, but the German military model, the Wehrmacht Enigma, is the version most commonly discussed.
The machine has gained notoriety because Polish mathematicians-cryptologists and then Allied cryptologists were able to decrypt a vast number of messages that had been enciphered on the machine. The intelligence gleaned from this source, codenamed ULTRA, was a substantial aid to the Allied war effort. The exact influence of ULTRA is debated, but an oft-repeated assessment is that decryption of German ciphers hastened the end of the European war by two years.[3][4][5]
Though the Enigma cipher had cryptographic weaknesses, in practice it was only in combination with other factors (procedural flaws, operator mistakes, occasional captured machines and key tables) that those weaknesses allowed Allied cryptologists to decrypt messages.[6]

Like other rotor machines, the Enigma machine is a combination of mechanical and electrical systems. The mechanical mechanism consists of a keyboard; a set of rotating disks called rotors arranged adjacently along a spindle; and a stepping mechanism to turn one or more of the rotors with each key press. The exact mechanism varies, but the most common form is for the right-hand rotor to step once with every key stroke, and occasionally the motion of neighbouring rotors is triggered. The continual movement of the rotors results in a different cryptographic transformation after each key press.
The mechanical parts act in such a way as to form a varying electrical circuit—the actual encipherment of a letter is performed electrically. When a key is pressed, the circuit is completed; current flows through the various components and ultimately lights one of many different lamps, indicating the output letter. For example, when encrypting a message starting ANX..., the operator would first press the A key, and the Z lamp might light; Z would be the first letter of the ciphertext. The operator would then proceed to encipher N in the same fashion, and so on.
To explain the Enigma, we use the wiring diagram on the left. To simplify the example, only four components of each are shown. In reality, there are 26 lamps, keys, plugs and wirings inside the rotors. The current flows from the battery (1) through the depressed bi-directional letter-switch (2) to the plugboard (3). The plugboard allows rewiring the connections between keyboard (2) and fixed entry wheel (4). Next, the current proceeds through the—unused, so closed—plug (3) via the entry wheel (4) through the wirings of the three (Wehrmacht Enigma) or four (Kriegsmarine M4 or Abwehr variant) rotors (5) and enters the reflector (6). The reflector returns the current, via a different path, back through the rotors (5) and entry wheel (4), and proceeds through plug 'S' connected with a cable (8) to plug 'D', and another bi-directional switch (9) to light-up the lamp.[7]
The continual changing of electrical paths through the unit because of the rotation of the rotors (which cause the pin contacts to change with each letter typed) implements the polyalphabetic encryption which provided Enigma's high security.

The rotors (alternatively "wheels" or "drums"—Walzen in German) form the heart of an Enigma machine. Approximately 10 cm in diameter, each rotor is a disc made of hard rubber or bakelite with a series of brass spring-loaded pins on one face arranged in a circle; on the other side are a corresponding number of circular electrical contacts. The pins and contacts represent the alphabet—typically the 26 letters A–Z (this will be assumed for the rest of the description). When placed side-by-side, the pins of one rotor rest against the contacts of the neighbouring rotor, forming an electrical connection. Inside the body of the rotor, a set of 26 wires connects each pin on one side to a contact on the other in a complex pattern. The wiring differs for every rotor.
By itself, a rotor performs only a very simple type of encryption—a simple substitution cipher. For example, the pin corresponding to the letter E might be wired to the contact for letter T on the opposite face. The complexity comes from the use of several rotors in series—usually three or four—and the regular movement of the rotors; this provides a much stronger type of encryption.
When placed in the machine, a rotor can be set to one of 26 positions. It can be turned by hand using a grooved finger-wheel which protrudes from the internal cover when closed. So that the operator knows the position, each rotor has an alphabet tyre (or letter ring) attached around the outside of the disk, with 26 letters or numbers; one of these can be seen through a window, indicating the position of the rotor to the operator. In early Enigma models, the alphabet ring is fixed; a complication introduced in later versions is the facility to adjust the alphabet ring relative to the core wiring. The position of the ring is known as the Ringstellung ("ring setting").
The rotors each contain a notch (sometimes multiple notches) used to control the stepping of the rotors. In the military versions, the notches are located on the alphabet ring.
The Army and Air Force Enigmas came equipped with several rotors; when first issued there were only three. On 15 December 1938, this changed to five, from which three were chosen for insertion in the machine. These were marked with Roman numerals to distinguish them: I, II, III, IV and V, all with single notches located at different points on the alphabet ring. This must have been intended as a security measure, but ultimately allowed the Polish Clock Method and British Banburismus attacks.
The Naval version of the Wehrmacht Enigma had always been issued with more rotors than the other services: at first, six, then seven and finally eight. The additional rotors were named VI, VII and VIII, all with different wiring, and had two notches cut into them at N and A, resulting in a more frequent turnover.
The four-rotor Naval Enigma (M4) machine accommodated an extra rotor in the same space as the three-rotor version. This was accomplished by replacing the original reflector with a thinner reflector and adding a special fourth rotor. The fourth rotor can be one of two types, "Beta" or "Gamma", and never steps, but it can be manually placed in any of the 26 positions.

To avoid merely implementing a simple (and easily breakable) substitution cipher, some rotors turned with consecutive presses of a key. This ensured the cryptographic substitution would be different at each position, producing a formidable polyalphabetic substitution cipher.
The most common arrangement used a ratchet and pawl mechanism. Each rotor had a ratchet with 26 teeth and, every time a key was pressed, each of the pawls corresponding to a particular rotor would move forward in unison and try to engage with a ratchet, thus advancing the rotor by a single step. Preventing this was a thin ring of metal attached to the previous rotor, upon which the pawl rode. As this ring rotated, a notch machined into it would eventually align itself with the pawl, allowing this to drop into position, engage with the ratchet and advance the rotor. The first rotor, having no previous rotor (and therefore no notched ring), would advance with every keystroke. The five basic rotors (I–V) had one notch each, while the additional naval rotors VI, VII and VIII had two notches. The position of the notch on each rotor could be adjusted.
If this were it, rotor one would step 26 times for every step of rotor two and rotor two 26 times for every step of rotor three. However, the design included a feature known as "double-stepping". This was enabled due to each pawl being aligned with both the ratchet of its rotor and the rotating notched ring of the neighbouring rotor. If a pawl was allowed to engage with a ratchet through alignment with a notch, as it moved forward it would push against both the ratchet and the notch, advancing both rotors at the same time. In a three-rotor machine the double-stepping would effect rotor two only. This, if in moving forward allowed the ratchet of rotor three to be engaged, would move again on the subsequent keystroke, thus resulting in two consecutive steps. Rotor two also pushes rotor one forward after 26 of its steps, but as rotor one moves forward with every keystroke anyway there is no double-stepping.[8] This double stepping caused the rotors to deviate from a normal odometer.
With three wheels and only single notches in the first and second wheels, the machine had a period of 26 × 25 × 26 = 16,900 (not 26 × 26 × 26 because of the double stepping of the second rotor.[8]) Historically, messages were limited to a couple of hundred letters, and so there was very little risk of repeating any position within a single message.
To make room for the naval fourth rotors "Beta" and "Gamma", introduced in 1942, the reflector was changed, by making it much thinner and the special thin fourth rotor was placed against it. No changes were made to rest of the mechanism. Since there were only three pawls, the fourth rotor never stepped, but could be manually set into one of its 26 positions.
When pressing a key, the rotors stepped before the electrical circuit is connected.

The entry wheel (Eintrittswalze in German), or entry stator, connects the plugboard, if present, or otherwise the keyboard and lampboard, to the rotor assembly. While the exact wiring used is of comparatively little importance to the security, it proved an obstacle in the progress of Polish cryptanalyst Marian Rejewski during his deduction of the rotor wirings. The commercial Enigma connects the keys in the order of their sequence on the keyboard: QA, WB, EC and so on. However, the military Enigma connects them in straight alphabetical order: AA, BB, CC etc. It took an inspired piece of guesswork for Rejewski to realise the modification.

With the exception of the early models A and B, the last rotor came before a "reflector" (German: Umkehrwalze, meaning "reversal rotor"), a patented feature distinctive of the Enigma family amongst the various rotor machines designed in the period. The reflector connected outputs of the last rotor in pairs, redirecting current back through the rotors by a different route. The reflector ensured that Enigma is self-reciprocal: conveniently, encryption was the same as decryption. However, the reflector also gave Enigma the property that no letter ever encrypted to itself. This was a severe conceptual flaw and a cryptological mistake subsequently exploited by codebreakers.
In the commercial Enigma model "C", the reflector could be inserted in one of two different positions. In Model D the reflector could be set in 26 possible positions, although it did not move during encryption. In the Abwehr Enigma, the reflector stepped during encryption in a manner like the other wheels.
In the German Army and Air Force Enigma, the reflector was fixed and did not rotate; there were four versions. The original version was marked A, and was replaced by Umkehrwalze B on 1 November 1937. A third version, Umkehrwalze C was used briefly in 1940, possibly by mistake, and was solved by Hut 6.[9] The fourth version, first observed on 2 January 1944 had a rewireable reflector, called Umkehrwalze D, allowing the Enigma operator to alter the connections as part of the key settings.

The plugboard (Steckerbrett in German) permitted variable wiring that could be reconfigured by the operator (visible on the front panel of Figure 1; some of the patch cords can be seen in the lid). It was introduced on German Army versions in 1930, and was soon adopted by the Navy as well. The plugboard contributed a great deal to the strength of the machine's encryption: more than an extra rotor would have done. Enigma without a plugboard—"unsteckered" Enigma—can be solved relatively straightforwardly using hand methods; these techniques are generally defeated by the addition of a plugboard, and Allied cryptanalysts resorted to special machines to solve it.
A cable placed onto the plugboard connected letters up in pairs, for example, E and Q might be a "steckered" pair. The effect was to swap those letters before and after the main rotor scrambling unit. For example, when an operator presses E, the signal was diverted to Q before entering the rotors. Several such steckered pairs, up to 13, might be used at one time.
Current flowed from the keyboard through the plugboard, and proceeded to the entry-rotor or Eintrittswalze. Each letter on the plugboard had two jacks. Inserting a plug disconnected the upper jack (from the keyboard) and the lower jack (to the entry-rotor) of that letter. The plug at the other end of the crosswired cable was inserted into another letter's jacks, thus switching the connections of the two letters.

A feature that was used on the M4 Enigma was the Schreibmax, a little printer which could print the 26 letters on a small paper ribbon. This did away with the need for a second operator to read the lamps and write the letters down. The Schreibmax was placed on top of the Enigma machine and was connected to the lamp panel. To install the printer, the lamp cover and all lightbulbs had to be removed. Besides its convenience, it could improve operational security; the printer could be installed remotely such that the signal officer operating the machine no longer had to see the decrypted plaintext information.
Another accessory was the remote lamp panel. If the machine was equipped with an extra panel, the wooden case of the Enigma was wider and could store the extra panel. There was a lamp panel version that could be connected afterwards, but that required, just as with the Schreibmax, that the lamp panel and lightbulbs be removed.[7] The remote panel made it possible for a person to read the decrypted plaintext without the operator seeing it.
In 1944 the Luftwaffe introduced an extra plugboard switch, called the Uhr (clock). There was a little box, containing a switch with 40 positions. It replaced the default plugs. After connecting the plugs, as determined in the daily key sheet, the operator turned the switch into one of the 40 positions, each position producing a different combination of plug wiring. Most of these plug connections were, unlike the default plugs, not pair-wise.[7] In one switch position, the Uhr did nothing simply emulating the 9 stecker wires with plugs.

The Enigma transformation for each letter can be specified mathematically as a product of permutations. Assuming a three-rotor German Army/Air Force Enigma, let P denote the plugboard transformation, U denote that of the reflector, and L,M,R denote those of the left, middle and right rotors repectively. Then the encryption E can be expressed as
After each key press, the rotors turn, changing the transformation. For example, if the right hand rotor R is rotated i positions, the transformation becomes ρiRρ − i, where ρ is the cyclic permutation mapping A to B, B to C, and so forth. Similarly, the middle and left-hand rotors can be represented as j and k rotations of M and L. The encryption transformation can then be described as

In German military usage, communications were divided up into a number of different networks, all using different settings for their Enigma machines. These communication nets were termed "keys" at Bletchley Park, and were assigned codenames, such as "Red", "Chaffinch" and "Shark". Each unit operating on a network was assigned a settings list for its Enigma for a period of time. For a message to be correctly encrypted and decrypted, both sender and receiver had to set up their Enigma in the same way; the rotor selection and order, the starting position and the plugboard connections must be identical. All these settings (together the key in modern terms) must have been established beforehand, and were distributed in codebooks.
An Enigma machine's initial state, the cryptographic key, has several aspects:
